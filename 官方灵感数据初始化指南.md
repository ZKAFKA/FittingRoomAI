# 官方灵感数据初始化指南

## 概述

本文档详细说明如何初始化官方灵感库数据，包括数据准备、图片上传、数据导入等步骤。

---

## 一、数据准备

### 官方灵感数据规范

每个官方灵感数据包含以下字段：

```javascript
{
  openid: null,
  nickName: 'FittingRoom AI',
  avatarUrl: '/assets/images/logo.png',
  imageUrl: '灵感图片URL',
  description: '描述文字',
  style: '风格分类',
  tags: ['标签1', '标签2', '标签3'],
  clothes: [
    {
      name: '服装名称',
      category: '类别',
      color: '颜色',
      style: '风格'
    }
  ],
  likes: 0,
  likedBy: [],
  views: 0,
  shares: 0,
  isOfficial: true,
  createTime: '创建时间（服务器时间）',
  status: 'active'
}
```

### 风格分类

| 风格 | 英文 | 说明 |
|-----|------|------|
| 休闲 | casual | 日常休闲风格 |
| 商务 | business | 商务职场风格 |
| 运动 | sport | 运动健身风格 |
| 时尚 | fashion | 时尚潮流风格 |
| 简约 | minimalist | 简约极简风格 |
| 复古 | vintage | 复古怀旧风格 |
| 街头 | street | 街头潮流风格 |
| 正式 | formal | 正式场合风格 |

### 服装类别

| 类别 | key | 说明 |
|-----|-----|------|
| 配饰 | accessory | 帽子、围巾、包包等 |
| 上装 | upper | T恤、衬衫、外套等 |
| 内搭 | inner | 内衣、打底衫等 |
| 下装 | lower | 裤子、裙子等 |
| 鞋子 | shoes | 运动鞋、皮鞋等 |
| 套装 | fullset | 整套搭配 |

---

## 二、图片准备

### 图片要求

1. **尺寸要求**
   - 宽度：750px - 1200px
   - 高度：1000px - 1600px
   - 比例：3:4 或 4:5

2. **文件大小**
   - 单张图片不超过2MB
   - 建议使用WebP格式以减小文件大小

3. **图片质量**
   - 分辨率：72dpi
   - 色彩模式：RGB
   - 清晰度：高清晰度，无模糊

4. **图片内容**
   - 展示完整的穿搭效果
   - 光线充足，色彩真实
   - 背景简洁，突出服装
   - 人物正面或微侧面

### 图片命名规范

格式：`inspiration-{编号}-{风格}.jpg`

示例：
- `inspiration-001-casual.jpg`
- `inspiration-002-business.jpg`
- `inspiration-003-sport.jpg`

### 图片存储路径

将所有官方灵感图片上传到云存储的以下路径：

```
inspirations/
  ├── official/
  │   ├── inspiration-001-casual.jpg
  │   ├── inspiration-002-business.jpg
  │   ├── inspiration-003-sport.jpg
  │   └── ...
```

---

## 三、数据示例

### 示例1：休闲风格

```javascript
{
  openid: null,
  nickName: 'FittingRoom AI',
  avatarUrl: '/assets/images/logo.png',
  imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-001-casual.jpg',
  description: '简约休闲风格，白色T恤搭配黑色牛仔裤，轻松舒适，适合日常穿搭',
  style: 'casual',
  tags: ['简约', '休闲', '日常', '舒适'],
  clothes: [
    {
      name: '白色T恤',
      category: 'upper',
      color: 'white',
      style: 'casual'
    },
    {
      name: '黑色牛仔裤',
      category: 'lower',
      color: 'black',
      style: 'casual'
    },
    {
      name: '白色运动鞋',
      category: 'shoes',
      color: 'white',
      style: 'sport'
    }
  ],
  likes: 0,
  likedBy: [],
  views: 0,
  shares: 0,
  isOfficial: true,
  createTime: '2024-01-01T00:00:00.000Z',
  status: 'active'
}
```

### 示例2：商务风格

```javascript
{
  openid: null,
  nickName: 'FittingRoom AI',
  avatarUrl: '/assets/images/logo.png',
  imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-002-business.jpg',
  description: '商务休闲风格，蓝色衬衫搭配黑色西裤，适合职场穿搭',
  style: 'business',
  tags: ['商务', '休闲', '职场', '专业'],
  clothes: [
    {
      name: '蓝色衬衫',
      category: 'upper',
      color: 'blue',
      style: 'business'
    },
    {
      name: '黑色西裤',
      category: 'lower',
      color: 'black',
      style: 'business'
    },
    {
      name: '黑色皮鞋',
      category: 'shoes',
      color: 'black',
      style: 'business'
    }
  ],
  likes: 0,
  likedBy: [],
  views: 0,
  shares: 0,
  isOfficial: true,
  createTime: '2024-01-01T00:00:00.000Z',
  status: 'active'
}
```

### 示例3：运动风格

```javascript
{
  openid: null,
  nickName: 'FittingRoom AI',
  avatarUrl: '/assets/images/logo.png',
  imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-003-sport.jpg',
  description: '运动健身风格，运动套装搭配运动鞋，活力十足',
  style: 'sport',
  tags: ['运动', '健身', '活力', '舒适'],
  clothes: [
    {
      name: '黑色运动上衣',
      category: 'upper',
      color: 'black',
      style: 'sport'
    },
    {
      name: '黑色运动裤',
      category: 'lower',
      color: 'black',
      style: 'sport'
    },
    {
      name: '白色运动鞋',
      category: 'shoes',
      color: 'white',
      style: 'sport'
    }
  ],
  likes: 0,
  likedBy: [],
  views: 0,
  shares: 0,
  isOfficial: true,
  createTime: '2024-01-01T00:00:00.000Z',
  status: 'active'
}
```

---

## 四、初始化步骤

### 步骤1：上传图片到云存储

1. **打开云开发控制台**
   - 点击"云开发"按钮
   - 选择"存储"标签

2. **创建目录**
   - 点击"新建文件夹"
   - 文件夹名称：`inspirations`
   - 进入`inspirations`文件夹
   - 创建子文件夹：`official`

3. **上传图片**
   - 进入`inspirations/official`文件夹
   - 点击"上传文件"
   - 选择准备好的所有官方灵感图片
   - 点击"确定"
   - 等待上传完成

4. **记录图片URL**
   - 上传完成后，点击每张图片
   - 复制图片的云存储URL
   - 格式：`cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-xxx.jpg`
   - 将URL记录到Excel或文本文件中

### 步骤2：创建初始化云函数

1. **创建云函数**
   - 打开云开发控制台 → 云函数
   - 点击"新建云函数"
   - 函数名称：`initInspirations`
   - 运行环境：Node.js 16.x
   - 点击"下一步"

2. **创建index.js文件**
   ```javascript
   const cloud = require('wx-server-sdk');
   cloud.init({
     env: cloud.DYNAMIC_CURRENT_ENV
   });

   const db = cloud.database();

   exports.main = async (event, context) => {
     const officialInspirations = [
       {
         openid: null,
         nickName: 'FittingRoom AI',
         avatarUrl: '/assets/images/logo.png',
         imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-001-casual.jpg',
         description: '简约休闲风格，白色T恤搭配黑色牛仔裤，轻松舒适，适合日常穿搭',
         style: 'casual',
         tags: ['简约', '休闲', '日常', '舒适'],
         clothes: [
           {
             name: '白色T恤',
             category: 'upper',
             color: 'white',
             style: 'casual'
           },
           {
             name: '黑色牛仔裤',
             category: 'lower',
             color: 'black',
             style: 'casual'
           },
           {
             name: '白色运动鞋',
             category: 'shoes',
             color: 'white',
             style: 'sport'
           }
         ],
         likes: 0,
         likedBy: [],
         views: 0,
         shares: 0,
         isOfficial: true,
         createTime: db.serverDate(),
         status: 'active'
       },
       {
         openid: null,
         nickName: 'FittingRoom AI',
         avatarUrl: '/assets/images/logo.png',
         imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-002-business.jpg',
         description: '商务休闲风格，蓝色衬衫搭配黑色西裤，适合职场穿搭',
         style: 'business',
         tags: ['商务', '休闲', '职场', '专业'],
         clothes: [
           {
             name: '蓝色衬衫',
             category: 'upper',
             color: 'blue',
             style: 'business'
           },
           {
             name: '黑色西裤',
             category: 'lower',
             color: 'black',
             style: 'business'
           },
           {
             name: '黑色皮鞋',
             category: 'shoes',
             color: 'black',
             style: 'business'
           }
         ],
         likes: 0,
         likedBy: [],
         views: 0,
         shares: 0,
         isOfficial: true,
         createTime: db.serverDate(),
         status: 'active'
       },
       {
         openid: null,
         nickName: 'FittingRoom AI',
         avatarUrl: '/assets/images/logo.png',
         imageUrl: 'cloud://fittingroom-prod-xxxxx/inspirations/official/inspiration-003-sport.jpg',
         description: '运动健身风格，运动套装搭配运动鞋，活力十足',
         style: 'sport',
         tags: ['运动', '健身', '活力', '舒适'],
         clothes: [
           {
             name: '黑色运动上衣',
             category: 'upper',
             color: 'black',
             style: 'sport'
           },
           {
             name: '黑色运动裤',
             category: 'lower',
             color: 'black',
             style: 'sport'
           },
           {
             name: '白色运动鞋',
             category: 'shoes',
             color: 'white',
             style: 'sport'
           }
         ],
         likes: 0,
         likedBy: [],
         views: 0,
         shares: 0,
         isOfficial: true,
         createTime: db.serverDate(),
         status: 'active'
       }
     ];

     const results = [];
     for (const inspiration of officialInspirations) {
       try {
         const result = await db.collection('inspirations').add({
           data: inspiration
         });
         results.push({
           id: result._id,
           style: inspiration.style,
           success: true
         });
       } catch (error) {
         results.push({
           style: inspiration.style,
           success: false,
           error: error.message
         });
       }
     }

     return {
       success: true,
       total: officialInspirations.length,
      successCount: results.filter(r => r.success).length,
      failCount: results.filter(r => !r.success).length,
      results
     };
   };
   ```

3. **创建package.json文件**
   ```json
   {
     "name": "initInspirations",
     "version": "1.0.0",
     "description": "初始化官方灵感库",
     "main": "index.js",
     "dependencies": {
       "wx-server-sdk": "~2.6.3"
     }
   }
   ```

4. **部署云函数**
   - 点击"上传并部署：云端安装依赖"
   - 等待部署完成

### 步骤3：执行初始化

1. **测试云函数**
   - 在云开发控制台找到`initInspirations`云函数
   - 点击"测试"按钮
   - 点击"调用"按钮
   - 查看返回结果：
     ```json
     {
       "success": true,
       "total": 3,
       "successCount": 3,
       "failCount": 0,
       "results": [
         {
           "id": "xxx",
           "style": "casual",
           "success": true
         },
         {
           "id": "xxx",
           "style": "business",
           "success": true
         },
         {
           "id": "xxx",
           "style": "sport",
           "success": true
         }
       ]
     }
     ```

2. **验证数据**
   - 打开云开发控制台 → 数据库 → inspirations集合
   - 查看是否成功插入了官方灵感数据
   - 确认`isOfficial`字段为`true`
   - 确认图片URL正确

---

## 五、批量导入工具

### 使用Excel批量导入

1. **准备Excel文件**
   - 创建Excel文件，包含以下列：
     - 编号
     - 风格
     - 描述
     - 标签（用逗号分隔）
     - 服装1名称
     - 服装1类别
     - 服装1颜色
     - 服装1风格
     - 服装2名称
     - 服装2类别
     - 服装2颜色
     - 服装2风格
     - 服装3名称
     - 服装3类别
     - 服装3颜色
     - 服装3风格
     - 图片URL

2. **转换为JSON**
   - 使用工具将Excel转换为JSON格式
   - 或手动编写转换脚本

3. **更新云函数**
   - 将转换后的JSON数据复制到`initInspirations`云函数
   - 重新部署云函数
   - 执行初始化

---

## 六、数据更新

### 更新现有官方灵感

1. **打开数据库**
   - 云开发控制台 → 数据库 → inspirations集合

2. **查找记录**
   - 使用查询条件找到要更新的记录
   - 例如：`isOfficial: true, style: 'casual'`

3. **更新记录**
   - 点击"编辑"按钮
   - 修改需要更新的字段
   - 点击"确定"

### 添加新的官方灵感

1. **上传新图片**
   - 将新图片上传到云存储
   - 记录图片URL

2. **添加记录**
   - 在inspirations集合中添加新记录
   - 设置`isOfficial: true`
   - 填写其他字段

---

## 七、数据清理

### 删除官方灵感

1. **打开数据库**
   - 云开发控制台 → 数据库 → inspirations集合

2. **查找记录**
   - 使用查询条件找到要删除的记录

3. **删除记录**
   - 点击"删除"按钮
   - 确认删除操作

### 批量删除

创建`cleanInspirations`云函数：

```javascript
const cloud = require('wx-server-sdk');
cloud.init({
  env: cloud.DYNAMIC_CURRENT_ENV
});

const db = cloud.database();
const _ = db.command;

exports.main = async (event, context) => {
  const { confirm } = event;
  
  if (!confirm) {
    return {
      success: false,
      message: '请设置confirm为true以确认清理操作'
    };
  }

  try {
    const res = await db.collection('inspirations')
      .where({
        isOfficial: true
      })
      .remove();
    
    return {
      success: true,
      count: res.stats.removed
    };
  } catch (error) {
    return {
      success: false,
      error: error.message
    };
  }
};
```

---

## 八、检查清单

完成官方灵感数据初始化后，请确认：

- [ ] 所有官方灵感图片已上传到云存储
- [ ] 图片URL已正确记录
- [ ] initInspirations云函数已创建并部署
- [ ] 云函数执行成功
- [ ] 数据库中已插入官方灵感数据
- [ ] isOfficial字段设置为true
- [ ] 图片URL正确
- [ ] 数据格式符合规范
- [ ] 标签分类正确
- [ ] 服装信息完整

---

## 九、注意事项

1. **图片质量**
   - 确保图片清晰、色彩真实
   - 避免模糊、失真的图片
   - 统一图片风格和尺寸

2. **数据准确性**
   - 确保服装信息准确
   - 标签分类合理
   - 描述文字简洁明了

3. **版权问题**
   - 确保使用的图片有合法版权
   - 避免使用侵权图片
   - 标注图片来源（如需要）

4. **定期更新**
   - 定期添加新的官方灵感
   - 更新过时的内容
   - 保持内容新鲜度

---

## 十、后续维护

### 定期任务

1. **每周**
   - 检查官方灵感的浏览量
   - 分析用户喜好
   - 策划新的灵感内容

2. **每月**
   - 添加新的官方灵感
   - 更新热门推荐
   - 优化标签分类

3. **每季度**
   - 审核所有官方灵感
   - 删除过时内容
   - 优化数据结构

---

**操作记录时间**：请在此记录完成时间
**操作人员**：请在此记录操作人员
**备注**：请在此记录遇到的问题和解决方案